

==================================================
SECTION: branches.rst
PATH: administration/odoo_sh/getting_started/branches.rst
==================================================

========
Branches
========

The :guilabel:`Branches` view provides an overview of the different branches in your repository.

.. _odoo-sh/branches/stages:

Stages
======

Odoo.sh offers three different branch stages:

- :ref:`Production <odoo-sh/branches/stages/production>`
- :ref:`Staging <odoo-sh/branches/stages/staging>`
- :ref:`Development <odoo-sh/branches/stages/development>`

You can change the stage of a branch by dragging and dropping it under the desired stage.

.. image:: branches/stages-move.gif
   :alt: Changing the stage of a branch

.. note::
   - Development branches can be moved under :guilabel:`Staging`. If you try to move a development
     branch under :guilabel:`Production`, a warning message will be displayed explaining that you
     can only have one production branch per project.
   - Staging branches can be moved under :guilabel:`Development`, but it is not possible to move
     them under :guilabel:`Production`.
   - The production branch can only be moved under :guilabel:`Development`. If you try to move it
     under :guilabel:`Staging`, you can only perform a merge. Refer to the
     :ref:`merging <odoo-sh/branches/stages/merging>` section for a detailed explanation of this
     process.

.. _odoo-sh/branches/stages/production:

Production
----------

The production branch contains the code used to run the production database. There can be only one
production branch.

When you push a new commit to this branch, the production server is updated with the revised code
and restarted.

If the changes require a module update, such as changing a form view, and you want the update to
be performed automatically, you can increase the module's version number in its manifest file
(:file:`__manifest__.py`). The platform then performs the update, during which the instance will be
held temporarily unavailable for maintenance reasons.

This method is equivalent to upgrading the module using the :guilabel:`Apps` menu or the `-u` switch
on :doc:`the command line <../../../developer/reference/cli>`.

.. note::
   - If the changes prevent the server from restarting or if the module update fails, the server is
     automatically reverted to the previous successful code revision, and the database is rolled
     back to its previous state. Access to the failed update's log to troubleshoot it.
   - The demo data is not loaded, as it is not intended for use on a production database. The `unit
     tests <https://en.wikipedia.org/wiki/Unit_testing>`_ are not performed, as it would increase
     the unavailability time of the production database during the update.

Odoo.sh automatically backs up the production database. It keeps seven daily, four weekly, and three
monthly backups. Each backup includes the database dump, the filestore (attachments and binary
fields), logs, and sessions.

.. warning::
   When using **trial projects**, the production branch and all staging branches are automatically
   set back to the development stage after **30 days**.

.. _odoo-sh/branches/stages/staging:

Staging
-------

Staging branches are meant to test new features using production data without compromising the
actual production database with test records. They create neutralized duplicates of the production
database.

The neutralization disables:

- Scheduled actions

  .. note::
     To test them, trigger them manually or re-enable them. Be aware that the platform will trigger
     them less often if no one is using the database in order to save resources.

- Outgoing emails

  .. note::
     They are instead intercepted using a mail catcher. An :ref:`interface to view the emails
     <odoo-sh/branches/tabs/mails>` sent by the database is provided in your Odoo.sh project.
     That way, no emails are sent to your contacts.

- IAP services

- Payment providers and shipping connectors

  .. note::
     They are put into test mode.

If you configure or view changes in a staging database, make sure to record them (noting them step
by step, reproducing in production, etc.) or write them directly in the branch's modules, using XML
data files to override the default configuration or views. Check the :ref:`first module
documentation <odoo-sh/module/add>` to view examples.

.. note::
   Unit tests are not performed. They rely on demo data, which is not loaded into the production and
   staging databases. If Odoo starts supporting running the units without demo data, Odoo.sh will
   then consider running the tests on staging databases.

Staging databases are not automatically backed up. Nevertheless, you can restore a backup of the
production database in a staging branch for testing purposes or to manually recover data that has
been accidentally deleted from the production database. It is possible to create manual backups of
staging databases.

.. warning::
   Databases created for staging branches are intended to last up to three months. After that, they
   can be automatically blocked without prior notice. Only rebuilding the branch will allow you to
   use that specific branch again.

.. _odoo-sh/branches/stages/development:

Development
-----------

Development branches create new databases using demo data to run the unit tests. The installed
modules are those included in the branch. You can change this list of modules to install in the
:doc:`project settings <settings>`.

When pushing a commit to a development branch, a new server is started, with a database created from
scratch, and the branch is updated. The demo data is loaded, and the unit tests are performed by
default to verify that the changes do not break any of the features being tested. You can disable
the tests or allow specific tests to be run with custom tags by going to the :ref:`branch's settings
<odoo-sh/branches/tabs/settings>`.

Similarly to staging branches, emails are not sent but are intercepted by a mail catcher, and
scheduled actions are not triggered as long as the database is not in use.

Development databases are not automatically backed up, and manual backups are not possible.

.. warning::
   Databases created for development branches are intended to last approximately three days. After
   that, they can be automatically garbage-collected to make room for new databases without prior
   notice.

.. _odoo-sh/branches/stages/merging:

Merging branches
----------------

You can merge your branches by dragging and dropping them into each other.

.. image:: branches/merging.gif
   :alt: Merging branches into each other

To test the changes of development branches with the production data, you can either:

- Merge the development branch into a staging branch by dragging and dropping it onto the desired
  branch; or

  .. image:: branches/merging-into-staging.gif
     :alt: Merging a development branch into a staging branch

- Drag and drop the development branch under the :guilabel:`Staging` section to make it a staging
  branch.

  .. image:: branches/moving-to-staging.gif
     :alt: Moving a development branch under staging

When the changes are ready for production, drag and drop the staging branch into the production
branch to merge and deploy them.

.. note::
   - You can merge development branches into the production branch directly. However, changes will
     not be validated against the production data through a staging branch, so there is a higher
     risk of encountering issues in the production database.
   - You can merge development branches into each other, and staging branches into each other.
   - You can also use `git merge` directly on your workstation to merge your branches. Odoo.sh is
     notified when new revisions are pushed to your branches.

Merging a staging branch into the production branch only merges the source code. Any changes made to
the staging database are not passed to the production database. However, if you modify the code in
the repository, it will be passed to the production branch when merging.

If you test configuration changes in staging branches, and want them to be applied to the production
branch, you have to, either:

- Write the configuration changes in XML data files to overide the default configuration or views in
  the branch, and then increase the version of the module in its manifest (:file:`__manifest__.py`)
  to trigger the module update when merging the staging branch in the production branch.

  .. note::
     This method is recommended for better scalability of your developments, as you will use the Git
     versioning features for all configuration changes, thereby ensuring traceability of your
     changes.

- Pass them manually from the staging database to the production one by copying and pasting them.

.. _odoo-sh/branches/tabs:

Tabs
====

.. _odoo-sh/branches/tabs/history:

History
-------

The :guilabel:`History` tab gives an overview of the branch history:

- The commit messages and their authors
- The various events linked to the platform, such as stage changes, database imports, and backup
  restores

.. image:: branches/history-tab.gif
   :alt: The branches' history tab

A status in the top right corner of each event indicates the current operation on the database
(e.g., installation, update, backup import) or its outcome (e.g., test feedback, successful backup
import). If an operation is successful, a :guilabel:`Connect` button appears, allowing you to access
the database.

.. _odoo-sh/branches/tabs/mails:

Mails
-----

The :guilabel:`Mails` tab contains the mail catcher, which provides an overview of emails sent by
the database.

.. note::
   The mail catcher is available for development and staging branches. Emails from the production
   database are actually sent and are not intercepted by the mail catcher.

.. image:: branches/mails-tab.png
   :alt: The branches' mails tab

.. _odoo-sh/branches/tabs/shell:

Shell
-----

The :guilabel:`Shell` tab provides shell access to the container.

Clicking :guilabel:`Shell` opens a new browser tab where you can run basic Linux commands (`ls`,
`top`). You can open a shell on the database by running `psql`.

.. image:: branches/shell-tab.png
   :alt: The branches' shell tab

.. tip::
   You can open multiple shell tabs at once and arrange their layout by dragging and dropping them.

.. note::
   - Production instance shells are highlighted in red to emphasize the danger of manipulating
     production instances directly, while staging/development instance shells are highlighted in
     yellow.
   - Long-running shell instances/idle shell sessions can be terminated at any time to free up
     resources.

.. _odoo-sh/branches/tabs/shell/commands:

Commands
~~~~~~~~

Here is an overview of useful commands that you can run an Odoo.sh database terminal:

- `odoo-bin shell`: to open an Odoo shell
- `odoo-update`: to update modules in the database
- `odoosh-restart`: to restart Odoo.sh services (http or cron)
- `odoosh-storage`: to check the storage usage of your instance's container filesystem
- `psql`: to open a database shell
- `mutt`: to check how emails appear on text clients (staging and development instances)
- `lnav ~/logs/odoo.log`: to navigate in your instance's :file:`odoo.log` file
- `ncdu`: to launch the disk usage analyzer with an interactive interface
- `grep`: to filter and find information in log or configuration files

.. _odoo-sh/branches/tabs/editor:

Editor
------

Clicking :guilabel:`Editor` opens a new browser tab to access an online integrated development
environment (IDE) to edit the source code. You can also open terminals, Python consoles, and Odoo
shell consoles.

.. image:: branches/online-editor.png
   :alt: The branches' editor tab

You can open multiple tabs and drag and drop them to arrange the layout as you wish.

.. seealso::
   :doc:`Online editor documentation <online_editor>`.

.. _odoo-sh/branches/tabs/monitor:

Monitor
-------

The :guilabel:`Monitor` tab displays various performance monitoring metrics of the current build.

Zoom in with your cursor to adjust the time range or select it manually from the time range
selector. It is also possible to change the time zone.

.. image:: branches/monitor-time-zone.gif
   :alt: The time range selector in the branches monitor tab

.. note::
   - Technical logs always use the :abbr:`UTC (Coordinated Universal Time)`. To analyze these logs
     together with your monitoring metrics, ensure :abbr:`UTC (Coordinated Universal Time)` is
     selected in the monitoring tool.
   - Similarly, when sending a support ticket, ensure the information you share is based on
     :abbr:`UTC (Coordinated Universal Time)`, as Odoo uses this time zone to investigate
     performance issues.

The information is aggregated periodically. When this is the case, a blue dotted line is displayed,
along with the tag :guilabel:`Aggregate Date`. This means that the data before this date will appear
flattened when compared to the data after this date. Therefore, when using the monitoring tool, it
is recommended to focus on recent events to get the most detailed information possible.

.. note::
   Dotted Lines of other colors help you relate to other changes on the build (database import,
   git push, etc.).

.. image:: branches/monitor-aggregate-date.png
   :alt: CPU monitoring aggregated data

.. tip::
   On each graph, an ùïö (:guilabel:`information`) icon is displayed in the top-left corner. Hover
   your mouse over it to get more details about what the graph represents.

.. _odoo-sh/branches/tabs/monitor/metrics:

Metrics
~~~~~~~

.. _odoo-sh/branches/tabs/monitor/metrics/system:

System
******

The :guilabel:`Memory` graph displays information about memory consumption:

- :guilabel:`Memory container` represents Odoo workers and container processes.
- :guilabel:`Memory postgresql` represents the database.

.. image:: branches/monitor-memory-graph.png
   :alt: The memory graph in the monitor tab

The :guilabel:`CPU` graph displays information about CPU consumption:

- :guilabel:`CPU http` represents Odoo workers.
- :guilabel:`CPU cron/mail` represents scheduled actions and incoming emails.
- :guilabel:`CPU postgresql` (database processes)
- :guilabel:`CPU other` represents webshells, the editor, etc.

.. image:: branches/monitor-cpu-graph.png
   :alt: The cpu graph in the monitor tab

The :guilabel:`Storage` graph displays information about the storage used:

- :guilabel:`Container` represents the filestore, log files, and user files.
- :guilabel:`Postgresql` represents the database and indexes.

.. image:: branches/monitor-storage-graph.png
   :alt: The storage graph in the monitor tab

.. _odoo-sh/branches/tabs/monitor/metrics/http:

HTTP
****

The :guilabel:`Requests` graph displays information about the number of HTTP requests per second:

- :guilabel:`HTTP successes` represents successful requests.
- :guilabel:`HTTP errors` represents failed requests (check :file:`odoo.log`).
- :guilabel:`HTTP rate limited` represents declined requests, possibly due to lack of workers.

.. image:: branches/monitor-requests-graph.png
   :alt: The requests graph in the monitor tab

The :guilabel:`Concurrent requests (max)` graph displays the maximum number of concurrent HTTP
requests per second.

.. image:: branches/monitor-concurrent-graph.png
   :alt: The concurrent rquests graph in the monitor tab

.. note::
   Database workers determine the number of concurrent requests that can be managed simultaneously.
   It is essential to have enough workers to handle all incoming requests as they arrive. However,
   having additional workers beyond this does not improve the speed at which requests are processed.

The :guilabel:`Average Response time` displays the average response time to HTTP requests (in
milliseconds).

.. image:: branches/monitor-response-graph.png
   :alt: The average response time graph in the monitor tab

.. _odoo-sh/branches/tabs/monitor/metrics/mails:

Mails
*****

The :guilabel:`Incoming` graph displays data about the daily number of incoming emails:

- :guilabel:`Received Emails` represents emails successfuly received.
- :guilabel:`Received Emails bounced` represents emails unsuccessfully received.

.. image:: branches/monitor-incoming-graph.png
   :alt: The incoming graph in the monitor tab

The :guilabel:`Outgoing` graph displays data about the daily number of outgoing emails:

- :guilabel:`Sent Emails` represents emails successfully sent.
- :guilabel:`Sent Emails bounced` represents emails unsuccessfully sent.

.. image:: branches/monitor-outgoing-graph.png
   :alt: The outgoing graph in the monitor tab

.. _odoo-sh/branches/tabs/logs:

Logs
----

The :guilabel:`Logs` tab offers a real-time view of your server's logs.

.. image:: branches/logs-tab.png
   :alt: The branches log tab

Different logs are available:

- `pip.log`: the Python dependencies installation
- `install.log`: the database installation (for development branches, tests are included)
- `odoosh-import-database.log`: the last imported dump process
- `odoo.log`: the running server
- `update.log`: the database updates
- `pg_slow_queries.log`: psql queries that take an unusual amount of time
- `sh_webshell.log`:  the actions taken in the webshell
- `sh_editor.log`: the actions taken in the editor
- `neutralize.log`: the neutralization of the database (only staging)

.. image:: branches/logs.gif
   :alt: Logs scrolling automatically

When new lines are added to the logs, they are displayed automatically. If you scroll to the bottom,
the browser scrolls automatically each time a new line is added.

You can pause the logs fetching process by clicking the :icon:`fa-pause` (:guilabel:`pause`) button
in the upper right corner. Otherwise, the process stops after five minutes. You can restart it by
clicking the :icon:`fa-play` (:guilabel:`play`) button.

.. _odoo-sh/branches/tabs/backups:

Backups
-------

The :guilabel:`Backups` tab lists the available backups to download and restore, lets you perform a
manual backup and import a database.

.. image:: branches/backups-tab.png
   :alt: The branches backups tab

The production database is automatically backed up daily. Seven daily, four weekly, and three
monthly backups are kept. Each backup includes the database dump, the filestore (attachments and
binary fields), logs, and sessions.

.. note::
   You can refer to `the estimated scheduling of automatic backups <https://docs.google.com/spreadsheets/d/e/2PACX-1vSJpyyyQ7kr5WSutkrDE3ybgpYySogseN7x2Og6fIbpPYABHe0q8xq0y0xh7P-QSHkX3RTTVqKMIExy/pubhtml?gid=0&single=true>`_
   to gain a better understanding of how the system works. This file is updated daily, taking the
   current day as the departure point.

Staging and development databases are not automatically backed up. However, you can restore a backup
of the production database in your staging branches, for testing purposes, or manually recover data
that has been accidentally deleted from the production database.

The list contains the backups kept on the server of your production database. This server only keeps
one month of backups: seven daily and four weekly backups.

Dedicated backup servers keep the same backups, as well as three additional monthly backups. To
restore or download one of these monthly backups, contact `Odoo Support
<https://www.odoo.com/help>`_.

When merging a commit updating the version of one or several modules (in :file:`__manifest__.py`),
or their linked Python dependencies (in :file:`requirements.txt`), then Odoo.sh performs an
automatic backup (flagged with type `Update` in the list), as either the container will be changed
by the installation of new pip packages, either the database itself will be changed with the module
update triggered afterwards. In these two cases, a backup is triggered as it may break something.

If the merged commit does not update the version of a module or linked dependencies, then no backup
is triggered by Odoo.sh, as neither the container nor the database is modified; therefore, the
platform considers this safe enough. As an extra precaution, you can make a manual backup before
modifiyng production sources.

The purpose of manual backups is to create a specific snapshot of production or staging databases
(not available for development). These remain available for seven days. However, there is a limit of
five daily manual backups.

.. list-table::
   :header-rows: 1
   :stub-columns: 1

   * - Stage
     - Automatic backup
     - Manual backup
   * - Production
     - Yes (up to 3 months)
     - Yes (3 days)
   * - Staging
     - No
     - Yes (3 days)
   * - Development
     - No
     - No

The :guilabel:`Import Database` feature accepts database archives from:

- the standard Odoo database manager (available for on-premise Odoo servers under
  `/web/database/manager`)
- the Odoo Online databases manager
- the Odoo.sh :guilabel:`Backups` tab (using the :icon:`fa-download` (:guilabel:`Download Options`)
  button)
- the Odoo.sh :doc:`Builds <builds>` view (by clicking :guilabel:`Download DB dump`)

.. _odoo-sh/branches/tabs/upgrade:

Upgrade
-------

The :guilabel:`Upgrade` tab can be used to upgrade production and staging branches of valid
projects. For more information about the upgrade process, refer to the :doc:`Upgrade documentation
<../../upgrade>`.

.. image:: branches/upgrade-tab.png
   :alt: The branches upgrade tab

.. _odoo-sh/branches/tabs/tools:

Tools
-----

The :guilabel:`Tools` tab contains the code profiler. It is used to start a profiling session,
recording the activities of Odoo workers running in the instance for a maximum of five minutes. You
can choose to terminate the session earlier, as running the tool for a shorter duration reduces the
amount of noise in the report.

.. image:: branches/code-profiler.gif
   :alt: Using the code profiler

After each session, an interactive flame graph is created to help you visualize how the Odoo workers
allocate their time.

.. warning::
   Running the profiler consumes a lot of server resources, so avoid letting it run for too long.
   The goal is to record a specific action in your database.

.. _odoo-sh/branches/tabs/settings:

Settings
--------

The :guilabel:`Settings` tab lists the configuration options available for the currently selected
branch. The options vary for each stage.

.. image:: branches/settings-tab.png
   :alt: The branches settings tab

.. _odoo-sh/branches/tabs/settings/commits:

Behavior upon new commits
~~~~~~~~~~~~~~~~~~~~~~~~~

You can change the branch's behavior upon receiving a new commit for **development** and **staging**
branches.

By default, a **development** branch creates a new build and a staging branch updates the previous
build. This is useful if the feature you are working on requires a specific configuration, as you
would not need to manually configure it again after every commit.

If you select :guilabel:`New build` for a **staging** branch, a fresh copy of the production build
is created every time a commit is pushed.

A branch that is moved from **staging** to **development** is set automatically to :guilabel:`Do
nothing`.

.. _odoo-sh/branches/tabs/settings/installation:

Module installation
~~~~~~~~~~~~~~~~~~~

You can choose which modules should be installed automatically for **development** branches.

.. image:: branches/settings-module-installation.png
   :alt: The settings tab module installation

To change the default behavior, untick the :guilabel:`Use Default` option under
:guilabel:`Development build behavior` and select one of the following options under
:guilabel:`Module Installation`:

- :guilabel:`Install only my modules (does not include submodules)`: only installs the branch's
  modules, excluding :doc:`submodules <../advanced/submodules>`. This is the default option.
- :guilabel:`Full installation (no test suite)`: installs the branch's modules, submodules, and all
  standard Odoo modules. When running the full installation, the test suite is disabled.
- :guilabel:`Install a list of modules`: installs the specified modules. To do so, enter their
  technical name, and separate them using commas (e.g., `sale_management,website,accountant`).

.. note::
   If the test suite is enabled, installing all standard Odoo modules can take up to one hour.

.. _odoo-sh/branches/tabs/settings/test:

Test suite
~~~~~~~~~~

By default, the test suite for **development** branches is enabled. You can restrict which tests are
run by entering :ref:`test tags <developer/reference/testing/selection>` and separating them using
commas (e.g., `custom_tags,at_install,post_install`).

To disable the test suite entirely, untick :guilabel:`Validate the test suite on new builds`.

.. _odoo-sh/branches/tabs/settings/version:

Odoo version
~~~~~~~~~~~~

You can change the version of Odoo for **development** branches, for example, to test upgraded code
or develop features while your production database is in the process of being upgraded to a newer
version, by selecting another :guilabel:`Version`.

By default, :guilabel:`Latest` is selected as the :guilabel:`Revision`, and the sources of your Odoo
server are updated weekly automatically to benefit from the latest bug, security, and performance
fixes.

To choose a specific revision instead, select it using the :guilabel:`Revision` field.

.. warning::
   Revisions expire after three months. You will be notified by email when the revision's expiration
   date approaches. If you have not taken any action when it expires, the :guilabel:`Revision` field
   is automatically set back to :guilabel:`Latest`.

.. image:: branches/settings-revisions.png
   :alt: The settings tab revisions

.. _odoo-sh/branches/tabs/settings/domain:

Custom domains
~~~~~~~~~~~~~~

You can configure additional `<name>.odoo.com` domains or your own custom domains for all branch
types.

To use your own custom domain, it is necessary to:

- Own or purchase the domain name.
- Enter the domain name under :guilabel:`Custom domains` (e.g., `www.mycompany.com`), then click
  :guilabel:`Add domain`.
- Configure the domain name (e.g., `www.mycompany.com`) using your registrar's domain name manager
  with a **CNAME** record value set to your production database domain name (e.g.,
  `mycompany.odoo.com`).

.. important::
   Bare domains (e.g., `mycompany.com`) are not accepted. They can only be configured using **A**
   records, which only accept IP addresses as their value. Therefore, a bare domain could suddenly
   cease to function, as the IP address of a database can change (e.g., following an upgrade, a
   hardware failure, a change of database hosting location).

To have both your bare domain (e.g., `mycompany.com`) and *www* domain (e.g., `www.mycompany.com`)
working, it is necessary to redirect the bare domain to the *www* domain. .com. Most domain managers
provide a way to configure this redirection, commonly referred to as a web redirection.

.. _odoo-sh/branches/tabs/settings/domain/https:

HTTPS/SSL
*********

If the redirection is correctly set up, an SSL certificate is automatically generated using `Let's
Encrypt <https://letsencrypt.org/about>`_ within the hour, meaning your domain will be accessible
through HTTPS.

.. _odoo-sh/branches/tabs/settings/domain/spf-dkim:

SPF and DKIM compliance
***********************

If the domain of your email addresses uses the :abbr:`SPF (Sender Policy Framework)` or :abbr:`DKIM
(DomainKeys Identified Mail)` authentication protocol, it is necessary to authorize Odoo as a
sending host in the domain name settings to increase the deliverability of outgoing emails. For more
information, refer to the :doc:`Configure DNS records to send emails in Odoo documentation
<../../../applications/general/email_communication/email_domain>`.

.. important::
   If Odoo is not authorized as a sending host, your outgoing emails may be flagged as spam.

.. _odoo-sh/branches/shell-commands:

Shell commands
==============

In the top right corner of the view, several shell commands are displayed. The commands can be
copied using the clipboard button and then used in a terminal. In addition, some of them can be used
directly from Odoo.sh's interface.

.. image:: branches/shell-commands.png
   :alt: The branches shell commands shortcuts

.. _odoo-sh/branches/shell-commands/clone:

Clone
-----

The clone command is used to create a local copy of your Git repository.

.. example::
   .. code-block:: shell

      git clone --recurse-submodules --branch development git@github.com:my-organization/my-repository.git

   - `--recurse-submodules` to download the submodules of your repository
   - `--branch main` to check out to a specific branch of the repository (e.g., `development`)

.. note::
   The run button is not available as the command is used to create a local copy on your machine.

.. _odoo-sh/branches/shell-commands/fork:

Fork
----

The fork command is used to create a new branch based on the current one.

.. example::
   .. code-block:: shell

      git checkout -b main-1 development && git push -u origin development-1

   - `git checkout -b main-1 main` a command to create a new branch (e.g., `development-1`)
     based on the current branch (e.g., `development`)
   - `git push -u origin development-1` a command to upload the new branch (e.g.,
     `development-1`) to the remote repository

.. _odoo-sh/branches/shell-commands/merge:

Merge
-----

The merge command is used to combine changes on one branch into another branch.

.. example::
   .. code-block:: shell

      git merge staging-1 && git push -u origin staging

   - `git merge staging-1` a command to merge the changes of the current branch into
     another branch (e.g., `staging-1`)
   - `git push -u origin staging` a command to upload the merged changes to the remote
     repository branch (e.g., `staging`)

.. _odoo-sh/branches/shell-commands/ssh:

SSH
---

The SSH command is used to connect to a build using SSH.

To use the SSH command, it is necessary to set up an SSH key first. To do so:

- `Generate a new SSH key <https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#generating-a-new-ssh-key>`_.
- `Copy the SSH key to your clipboard <https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account#adding-a-new-ssh-key-to-your-account>`_.
- On Odoo.sh, click your GitHub user in the top-right corner and select :guilabel:`Profile`.

  .. image:: branches/ssh-profile.png
     :alt: Accessing a user's profile

- Paste the SSH key under the :guilabel:`Add a key manually` field and click :guilabel:`Add`.

  .. image:: branches/ssh-add-key.gif
     :alt: Adding an SSH key manually

.. example::
   .. code-block:: shell

      ssh 25004381@my-user-my-repository-staging-25004381.dev.odoo.com

   - `25004381` the build ID
   - `my-user-my-repository-staging-25004381.dev.odoo.com` the domain used to connect to the build

Provided you have the necessary :ref:`access rights <odoo-sh/settings/collaborators>` on the
project, you will be granted SSH access to the build.

.. note::
   Long-running SSH connections are not guaranteed. Idle connections can be disconnected to free up
   resources.

.. _odoo-sh/branches/shell-commands/submodule:

Submodule
---------

The submodule command is used to add a branch from another repository to your current branch as a
submodule.

.. seealso::
   :doc:`Submodules documentation <../advanced/submodules>`

.. example::
   .. code-block:: shell

      git submodule add -b master <URL> <PATH> && git commit -a && git push -u origin staging

   - `git submodule add -b master <URL> <PATH>` a command to add a specific branch (e.g.,
     `master`) of a repository (`<URL>`) as a submodule under the specified path (`<PATH>`) in
     your current branch.
   - `git commit -a` a command to commit all current changes
   - `git push -u origin staging` a command to upload the changes of the current branch
     (e.g., `staging`) to the remote repository.

.. _odoo-sh/branches/shell-commands/delete:

Delete
------

The delete command is used to delete a branch from your repository.

.. note::
   Once you delete a branch, there is no way to retrieve it unless a backup exists. Staging branches
   are not automatically backed up, but can be manually. Development branches cannot be backed up.

.. example::
   .. code-block:: shell

      git push origin :staging && git branch -D staging

   - `git push origin :staging` a command to delete a specific branch (e.g., `staging`) on
     the remote repository
   - `git branch -D staging` a command to delete the specific branch on your local copy of
     the repository

.. warning::
   Before deleting a branch, refer to the :ref:`Backups section <odoo-sh/branches/tabs/backups>` to
   better understand how they work and when you should create a manual backup.


==================================================
SECTION: builds.rst
PATH: administration/odoo_sh/getting_started/builds.rst
==================================================

======
Builds
======

In Odoo.sh, a build is a database loaded by an Odoo server (`odoo/odoo
<https://github.com/odoo/odoo>`_ and `odoo/enterprise <https://github.com/odoo/enterprise>`_)
running on a specific revision of your project repository in a containerized environment. Its
purpose is to test the proper behavior of the server, the database, and the features associated with
that revision.

.. _odoo-sh/builds/overview:

Overview
========

.. image:: builds/builds-overview.png
   :alt: Overiew of the builds

In the :guilabel:`Builds` view, a row represents a branch, and a cell within that row represents
a build of that branch.

Most builds are created after pushes to your GitHub repository branches. They can also be created
through other operations, such as importing a database on Odoo.sh or requesting a rebuild for a
branch in your project.

Builds can have three possible statuses:

- A build is considered **successful** if no errors or warnings occur during its creation.
  Successful builds are highlighted in **green**.
- A build is considered **almost successful** if warnings occur, but there are no errors. Almost
  successful builds are highlighted in **yellow**.
- A build is considered **failed** if errors occur during its creation. Failed builds are
  highlighted in **red**.

.. note::
   Builds do not always create a database from scratch. For instance, when pushing a change on the
   production branch, the created build starts the server with your new revision and tries to load
   the current production database on it.

.. _odoo-sh/builds/stages:

Stages
======

.. _odoo-sh/builds/stages/production:

Production
----------

The first build of a production branch creates a database from scratch. If this build is successful,
this database will become the production database of your project.

From then on, pushes to the production branch will create new builds that attempt to load the
database using a server running the new revision.

If the build is successful or almost successful, the production database will run with this build
and its associated revision.

If the build fails to load or update the database, the previous successful build is reused to load
the database. In that case, the database continues to run using the previous successful revision.

.. note::
   The build used to run the production database is always the first in the builds list. If a build
   fails, it is placed after the build currently running the production database.

.. _odoo-sh/builds/stages/staging:

Staging
-------

Staging builds duplicate the production database and attempt to load this copy using the revisions
of the staging branches.

Each time you push a new revision to a staging branch, the resulting build uses a fresh copy of the
production database. Databases are not reused between builds of the same branch. This ensures that:

- Staging builds use databases that closely match the current production state, so your tests are
  not performed on outdated data.
- You can freely experiment within a staging database. When you want to start over with a new copy
  of the production database, you can request a rebuild.

However, this also means that if you make configuration changes in a staging database and do not
apply them in production, those changes will not be present in the next build of the same staging
branch.

.. _odoo-sh/builds/stages/development:

Development
-----------

Development builds create new databases, load the demo data, and run the unit tests.

A build will be considered failed if tests fail during installation, as they are designed to raise
errors when something is wrong.

If all tests pass and no errors occur, the build is considered successful.

.. note::
   Depending on the list of modules to install and test, a development build can take up to one hour
   to be ready. This is due to the large number of tests included in the default Odoo module suite.

.. _odoo-sh/builds/stages/features:

Features
========

The production branch always appears first. Other branches are ordered by the time of their last
created build. The stage highlighted in purple corresponds to the stage selected in the
:guilabel:`Branches` menu.

.. tip::
   You can filter branches using the search bar.

.. image:: builds/branches-menu.png
   :alt: The branches menu

For each branch, you can:

- Access the latest build's database by clicking :guilabel:`Connect`.
- Jump to the branch's code by clicking :guilabel:`Github`.
- Create a new build by clicking :guilabel:`Rebuild`. It uses the latest revision of the branch (it
  is not available if a build is already in progress for that branch).

For each build, you can:

- View the revision changes by clicking the :icon:`fa-github` (:guilabel:`GitHub`) icon.
- Access the build's database as the administrator by clicking :guilabel:`Connect` or as another
  user by clicking the :icon:`fa-caret-down` (:guilabel:`More Actions`) button next to
  :guilabel:`Connect` and selecting :guilabel:`Connect as`.
- Access the same tools as in the branches view by clicking the :icon:`fa-caret-down`
  (:guilabel:`More Actions`) button next to :guilabel:`Connect` and selecting :guilabel:`Logs`,
  :guilabel:`Web Shell`, :guilabel:`Editor`, :guilabel:`Outgoing e-mails` (for the staging and
  development stages), :guilabel:`Monitoring`, and :guilabel:`Download DB dump` (for the production
  and staging stages).

.. image:: builds/builds-options.png
   :alt: A build's options


==================================================
SECTION: create.rst
PATH: administration/odoo_sh/getting_started/create.rst
==================================================

================
Create a project
================

Deploy a platform
=================

#. Visit `Odoo.sh <https://www.odoo.sh>`_ and click :guilabel:`Deploy your platform`.

   .. image:: create/deploy-button.png
      :alt: The Deploy your platform button on Odoo.sh

#. Sign in with a `GitHub <https://github.com>`_ account.

   .. image:: create/github-sign-in.png
      :alt: Signing in to GitHub

#. Authorize Odoo.sh by clicking :guilabel:`Authorize odoo` twice.

   .. image:: create/github-authorize.png
      :alt: Granting Odoo.sh permissions to perform actions and access data on GitHub

   .. image:: create/github-authorize.png
      :alt: Granting Odoo.sh additional permissions to perform actions and access data on GitHub

   .. note::
      Odoo.sh requests GitHub to:

      - Access your GitHub login and email.
      - Create a new repository, in case you start from scratch.
      - Access existing repositories, including organization ones, in case you start from an
        existing repository.
      - Create a webhook to notify you each time changes are pushed.
      - Commit changes for easier deployment.

#. Fill in the :guilabel:`Deploy your platform` form and click :guilabel:`Deploy`:

   - :guilabel:`Github repository`: to create a new repository, choose :guilabel:`New repository`
     and enter a name; to use an existing one, choose :guilabel:`Existing repository` and select it.
   - :guilabel:`Odoo Version`: select the major version of Odoo you want to use.

     .. tip::
        - Use the latest major version of Odoo version when creating a new repository. If you are
          planning to import an existing database or applications, it might be required that their
          versions match.
        - If you are starting on Odoo Online and plan to migrate to Odoo.sh later, create your
          database using `odoo.com/start-lts <https://www.odoo.com/start-lts>`_ to ensure
          compatibility, as minor versions are not supported by Odoo.sh.

   - :guilabel:`Subscription Code`: enter your Odoo Enterprise subscription code that includes
     Odoo.sh. It is also sometimes called the *subscription referral*, *contract number*, or
     *activation code*.

      .. tip::
         Partners can use their partnership codes to initiate a trial (trial builds are limited to 1
         GB storage and two staging). If a client proceeds to start a project, they must subscribe
         to an Odoo Enterprise plan that includes Odoo.sh hosting and use their subscription code.

   - :guilabel:`Hosting location`: select the region where your platform will be hosted.

   .. image:: create/deploy-form.png
      :alt: The Deploy your platform form

.. _odoo-sh/create/import:

Import a database
=================

Once your platform is deployed, you can import a database into your Odoo.sh project, provided it
uses a :doc:`supported version <../../standard_extended_support>` of Odoo.

.. note::
   Due to `Odoo's backup policy <https://www.odoo.com/cloud-sla>`_, the import process requires
   **four times** the size of your database dump in available storage. For example, a 10 GB dump
   file will require at least 40 GB of available space. We recommend allocating **more than four
   times√ó** the dump size temporarily, then reducing storage after the import is complete.

   If your project is a trial created with a partnership code, you can only import database dumps up
   to **1 GB** in size.

Push modules in production
--------------------------

If you are using community or custom modules, add them to a branch in your GitHub repository.

.. note::
   Databases hosted on Odoo Online do not support custom modules.

Odoo.sh automatically detects folders containing Odoo modules. You can organize them however you
prefer. For example, you can place them directly in the root directory of your repository or group
them by category (e.g., `accounting`, `project`, etc.).

For publicly available community modules, you may also consider using :doc:`submodules
<../advanced/submodules>`.

Download a backup
-----------------

.. tabs::

   .. group-tab:: On-premise

      Go to `/web/database/manager` on your on-premise Odoo instance and click :icon:`fa-floppy-o`
      :guilabel:`Backup`.

      .. image:: create/on-premise-manager.png
         :alt: The on-premise web manager interface

      Select :guilabel:`zip (includes filestore)` as the :guilabel:`Backup Format`.

      .. image:: create/on-premise-backup.png
         :alt: Downloading an on-premise database backup

      .. note::
         - You will need the :guilabel:`Master Password` of your Odoo server. If you do not have it,
           contact your system administrator.
         - If you cannot access the database manager, it may have been disabled by your system
           administrator. Refer to the :ref:`database manager security documentation
           <db_manager_security>`.

   .. group-tab:: Odoo Online

      Log in to your portal account and navigate to the `My Databases page
      <https://www.odoo.com/my/databases>`_, and download a backup by clicking the :icon:`fa-gear`
      (:guilabel:`gear`) icon, then :icon:`fa-cloud-download` :guilabel:`Download`.

      .. image:: create/odoo-online-backup.png
         :alt: Downloading an Odoo Online database backup

      .. warning::
         Only major versions of Odoo are compatible with Odoo.sh.

Upload the backup
-----------------

In your Odoo.sh project, navigate to the :guilabel:`Backups` tab of your :guilabel:`Production`
branch, and click :guilabel:`Import Database` to upload the backup you previously downloaded.

.. image:: create/import-database.png
   :alt: Importing a database backup on Odoo.sh

Once the import is complete, you can access the database using the :guilabel:`Connect` button in the
branch's :guilabel:`History` tab.

.. important::
   Importing a backup **overwrites all data** currently in the branch. Consider downloading a manual
   backup beforehand if you want to preserve the existing data.

Check outgoing email servers
----------------------------

Odoo.sh provides a default email server. To use it, ensure that **no outgoing mail server is
enabled** in your database by enabling :ref:`developer mode <developer-mode>` and navigating to
:menuselection:`Settings --> Technical --> Email: Outgoing Mail Servers`

After importing your database, all configured outgoing mail servers are **disabled**, and the
default Odoo.sh server is used.

.. warning::
   Port **25** is and will remain closed. If connecting to an external SMTP server, use port **465**
   or **587**.

Check scheduled actions
-----------------------

Scheduled actions are **disabled by default** after importing your database. This prevents your
newly imported database from performing potentially disruptive operations such as:

- sending queued emails,
- triggering mass mailings, or
- syncing with third-party services (e.g., calendars, cloud storage).

If you intend to use this imported database in production, **re-enable** only the scheduled actions
you need by enabling :ref:`developer mode <developer-mode>` and going to :menuselection:`Settings
--> Technical --> Automation: Scheduled Actions`.

Register the subscription
-------------------------

After import, the database is considered a **duplicate** and will be unlinked from your enterprise
subscription.

.. note::
   You are allowed only one active database per subscription.

If you intend to make the imported database your production environment:

#. Unlink your previous database from the subscription.
#. Register the new one.

Refer to the :doc:`database registration documentation <../../on_premise>` for step-by-step
instructions.


==================================================
SECTION: getting_started.rst
PATH: administration/odoo_sh/getting_started.rst
==================================================

:show-content:

===============
Getting started
===============

Main components
---------------

When working with Odoo.sh, it is important to understand the main components involved. While they
are all interconnected, each one plays a distinct role in the development and deployment of Odoo
applications:

- **GitHub repository**: a version-controlled space where the Odoo applications' source code is
  stored. It tracks every change, supports collaboration, and can be either public or private.

  .. image:: getting_started/github-repository.png
     :alt: Example of a GitHub repository

- **Odoo.sh project**: a Platform as a Service (PaaS) that integrates with GitHub and enables
  streamlined development, testing, and deployment of Odoo applications. It includes tools such as
  automated backups, staging environments, and continuous integration pipelines.

  .. image:: getting_started/odoo-sh-project.png
     :alt: Example of an Odoo.sh project

- **Odoo database**: a database stores all the operational data used and generated by Odoo
  applications, such as business records, configurations, and user data.

  .. image:: getting_started/odoo-database.png
     :alt: Example of an Odoo database

Together, they form a cohesive pipeline from code development to a live business use.

User types
----------

Odoo.sh involves different types of users, each with a specific role in the project lifecycle:

- GitHub users: developers with access to the GitHub repository linked to the Odoo.sh project.
  Access to the repository does not automatically make someone a collaborator on the Odoo.sh
  project.

- Odoo.sh collaborators: individuals managing the Odoo.sh project. Each collaborator must be
  linked to a GitHub user. However, collaborators are not the same as database users.

- Database users: end-users of the deployed Odoo database. They interact with the live system but
  are not involved in development or project management.

.. toctree::
   :titlesonly:

   getting_started/create
   getting_started/branches
   getting_started/builds
   getting_started/settings
   getting_started/online_editor


==================================================
SECTION: online_editor.rst
PATH: administration/odoo_sh/getting_started/online_editor.rst
==================================================

=============
Online editor
=============

The :guilabel:`Online Editor` view allows editing the source code of your builds from a web browser.
It also gives you the possibility to open terminals, Python consoles, Odoo shell consoles, and
`Jupyter Notebooks <https://jupyterlab.readthedocs.io/en/stable/user/notebook.html>`_.

.. image:: online_editor/online-editor.png
   :alt: Overview of the online editor

You can access the editor of a build through :ref:`the branches tab <odoo-sh/branches/tabs>`,
:ref:`the builds dropdown menu <odoo-sh/builds/stages/features>`, or by adding `/odoo-sh/editor` to
the build's URL (e.g., `https://odoo-addons-master-1.dev.odoo.com/odoo-sh/editor`).

.. _odoo-sh/editor/source:

Editing the source code
=======================

The working directory is composed of the following:

::

  .
  ‚îú‚îÄ‚îÄ home
  ‚îÇ    ‚îî‚îÄ‚îÄ odoo
  ‚îÇ         ‚îú‚îÄ‚îÄ src
  ‚îÇ         ‚îÇ    ‚îú‚îÄ‚îÄ odoo                Odoo Community source code
  ‚îÇ         ‚îÇ    ‚îÇ    ‚îî‚îÄ‚îÄ odoo-bin       Odoo server executable
  ‚îÇ         ‚îÇ    ‚îú‚îÄ‚îÄ enterprise          Odoo Enterprise source code
  ‚îÇ         ‚îÇ    ‚îú‚îÄ‚îÄ themes              Odoo Themes source code
  ‚îÇ         ‚îÇ    ‚îî‚îÄ‚îÄ user                Your repository branch source code
  ‚îÇ         ‚îú‚îÄ‚îÄ data
  ‚îÇ         ‚îÇ    ‚îú‚îÄ‚îÄ filestore           Database attachments, as well as the files of binary fields
  ‚îÇ         ‚îÇ    ‚îî‚îÄ‚îÄ sessions            Visitors and users sessions
  ‚îÇ         ‚îî‚îÄ‚îÄ logs
  ‚îÇ              ‚îú‚îÄ‚îÄ install.log         Database installation logs
  ‚îÇ              ‚îú‚îÄ‚îÄ odoo.log            Running server logs
  ‚îÇ              ‚îú‚îÄ‚îÄ update.log          Database updates logs
  ‚îÇ              ‚îî‚îÄ‚îÄ pip.log             Python packages installation logs

You can edit the source code (files under `/src`) of development and staging builds. For production
builds, the source code is read-only, because applying local changes on a production server is not a
good practice.

.. note::
   - Your changes won't be propagated to new builds. It is necessary to :ref:`commit them to the
     source code <odoo-sh/editor/commit>` if you want them to persist.
   - The source code of your GitHub repository is located under `/src/user`.
   - The source code of Odoo is located under:

     - `/src/odoo` (`<https://github.com/odoo/odoo>`_)
     - `/src/enterprise` (`<https://github.com/odoo/enterprise>`_)
     - `/src/themes` (`<https://github.com/odoo/design-themes>`_)

To open a file in the editor, double-click it in the file browser panel. You can then edit the file.
To save your changes, go to :menuselection:`File --> Save` or use the :kbd:`Ctrl+S` keyboard
shortcut.

If you save a Python file in your Odoo server's addons path, Odoo will detect it and reload
automatically, meaning your changes are immediately visible.

.. image:: online_editor/auto-reload.gif
   :alt: Change to a Python file being immediately visible

However, if your changes are stored in the database, such as a field's label or a view, it is
necessary to update the related module to apply the changes. To update the module of the currently1
open file, go to :menuselection:`Odoo --> Update current module`.

.. image:: online_editor/update-module.png
   :alt: Using the editor to update the current module

.. tip::
   You can also execute the following command in a terminal to update a module:

   .. code-block:: bash

      odoo-bin -u <comma-separated module names> --stop-after-init

.. _odoo-sh/editor/commit:

Committing and pushing changes
==============================

To commit and push changes to your GitHub repository:

- Open a terminal by going to :menuselection:`File --> New --> Terminal`.
- Change the directory to `~/src/user`.

  .. code-block:: bash

     cd ~/src/user

- State your identity.

  .. code-block:: bash

     git config --global user.email "you@example.com" && git config --global user.name "Your Name"

- Stage your changes.

  .. code-block:: bash

     git add

- Commit your changes.

  .. code-block:: bash

     git commit

- Push your changes.

  .. code-block:: bash

     git push https HEAD:<branch>

  In this command:

  - `https` is the name of your *HTTPS* GitHub remote repository (e.g.,
    `https://github.com/username/repository.git`).
  - `HEAD` is the reference to the latest revision you committed.
  - `<branch>` must be replaced by the name of the branch to which you want to push the changes,
    most likely the current branch if you work on a development build.

You will be prompted to input your GitHub username and password. After inputting your credentials,
press enter.

.. image:: online_editor/commit-push.png
   :alt: The commands to commit and push changes

.. tip::
   If you activate two-factor authentication for your GitHub account, you can create a `personal
   access token <https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-fine-grained-personal-access-token>`_
   and use it as a password. `Granting the repo permission <https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/repository-access-and-collaboration/inviting-collaborators-to-a-personal-repository>`_
   suffices.

.. note::
   - It is not possible to authenticate yourself using SSH, as your private SSH key is not hosted in
     your build containers for security reasons, nor forwarded through an SSH agent, as you access
     the editor through a web browser.
   - The source folder `~/src/user` is not checked out on a branch but rather on a detached
     revision. This is because builds work on specific revisions rather than branches, meaning you
     can have multiple builds on the same branch, but on different revisions.

Once your changes are pushed, according to your :ref:`branch push behavior
<odoo-sh/branches/tabs/settings>`, a new build may be created. You can continue to work in the editor
you pushed from, as it will have the same revision as the new build that was created. However,
always make sure to be in the editor of a build using the latest revision of your branch.

.. _odoo-sh/editor/consoles:

Consoles
========

You can open Python consoles, which are `IPython interactive shells
<https://ipython.readthedocs.io/en/stable/interactive/tutorial.html>`_. Using these Python consoles
(rather than IPython shells within a terminal) allows you to utilize their `rich display
capabilities <https://ipython.readthedocs.io/en/stable/config/integrating.html#rich-display>`_ to
display objects in HTML.

.. example::
   The :code:`Pretty` class displays lists in a legible way.

   .. image:: online_editor/pretty-class.png
      :alt: Pretty class example

.. tip::
   Using `pandas <https://pandas.pydata.org/pandas-docs/stable/getting_started/tutorials.html>`_ you
   can display:

   - Cells of a CSV file

     .. image:: online_editor/pandas-csv.png
        :alt: pandas CSV example

   - Graphs

     .. image:: online_editor/pandas-graph.png
        :alt: pandas graph example

You can open Odoo shell consoles to experiment with the Odoo registry and model methods of your
database. You can also read or write directly on your records.

.. warning::
   In an Odoo shell console, transactions are automatically committed. This means that changes made
   to records are applied to the database. For example, if you change a user's name, it will be
   updated in your database as well. Therefore, use Odoo shell consoles carefully on production
   databases.

You can use `env` to invoke models of your database registry, e.g., :code:`env['res.users']`.

.. code-block:: python

   env['res.users'].search_read([], ['name', 'email', 'login'])
   [{'id': 2,
   'login': 'admin',
   'name': 'Administrator',
   'email': 'admin@example.com'}]


==================================================
SECTION: settings.rst
PATH: administration/odoo_sh/getting_started/settings.rst
==================================================

========
Settings
========

The :guilabel:`Settings` view allow you to manage the configuration of your project.

.. _odoo-sh/settings/name:

Project name
============

The name of your project defines the address used to access your production database. The addresses
of your staging and development builds are automatically derived from this name. If you change the
project name, only future builds will use the new name.

.. image:: settings/project-name.png
   :alt: The project name setting

.. _odoo-sh/settings/collaborators:

Collaborators
=============

To grant access to a GitHub user, enter their username and click :guilabel:`Add`. By default, the
user is is granted the :guilabel:`Developer` role. Click the dropdown menu to select another one:

- :guilabel:`Admin`: full access to all Odoo.sh features and tools. This role is dedicated to
  project management and has exclusive access to the project's settings.
- :guilabel:`Tester`: access to staging and development databases and their tools. This role is
  intended for users performing user acceptance testing (UAT). Testers can work with copies of
  production data, but they cannot access the production database through Odoo.sh's tools.
- :guilabel:`Developer`: no access to the production and staging databases. This role is intended
  for users who modify the code but should not access production data. Developers cannot connect to
  the production or staging databases and do not have access to the web shell or server logs.

.. image:: settings/collaborators.png
   :alt: The collaborators setting

.. _odoo-sh/settings/collaborators/table:

Feature access by stage and role
--------------------------------

.. list-table::
   :header-rows: 1
   :stub-columns: 1
   :widths: auto

   * - Stage
     - Feature
     - Developer
     - Tester
     - Admin
   * - Development
     - Connect + / Connect as
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`History <odoo-sh/branches/tabs/history>`
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`Mails <odoo-sh/branches/tabs/mails>`
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`Editor <odoo-sh/branches/tabs/editor>`
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`Monitor <odoo-sh/branches/tabs/monitor>`
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`Logs <odoo-sh/branches/tabs/logs>`
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`Upgrade <odoo-sh/branches/tabs/upgrade>`
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`Settings <odoo-sh/branches/tabs/settings>`
     - |green|
     - |green|
     - |green|
   * -
     - Status
     - |green|
     - |green|
     - |green|
   * - Staging
     - Connect + / Connect as
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`History <odoo-sh/branches/tabs/history>`
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`Mails <odoo-sh/branches/tabs/mails>`
     - |red|
     - |green|
     - |green|
   * -
     - :ref:`Shell <odoo-sh/branches/tabs/shell>`
     - |red|
     - |green|
     - |green|
   * -
     - :ref:`Editor <odoo-sh/branches/tabs/editor>`
     - |red|
     - |green|
     - |green|
   * -
     - :ref:`Monitor <odoo-sh/branches/tabs/monitor>`
     - |red|
     - |green|
     - |green|
   * -
     - :ref:`Logs <odoo-sh/branches/tabs/logs>`
     - |red|
     - |green|
     - |green|
   * -
     - :ref:`Upgrade <odoo-sh/branches/tabs/upgrade>`
     - |red|
     - |green|
     - |green|
   * -
     - :ref:`Settings <odoo-sh/branches/tabs/settings>`
     - |red|
     - |green|
     - |green|
   * -
     - Status
     - |green|
     - |green|
     - |green|
   * - Production
     - Connect + / Connect as
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`History <odoo-sh/branches/tabs/history>`
     - |green|
     - |green|
     - |green|
   * -
     - :ref:`Shell <odoo-sh/branches/tabs/shell>`
     - |red|
     - |red|
     - |green|
   * -
     - :ref:`Editor <odoo-sh/branches/tabs/editor>`
     - |red|
     - |red|
     - |green|
   * -
     - :ref:`Monitor <odoo-sh/branches/tabs/monitor>`
     - |red|
     - |red|
     - |green|
   * -
     - :ref:`Logs <odoo-sh/branches/tabs/logs>`
     - |red|
     - |red|
     - |green|
   * -
     - :ref:`Backups <odoo-sh/branches/tabs/backups>`
     - |red|
     - |red|
     - |green|
   * -
     - :ref:`Upgrade <odoo-sh/branches/tabs/upgrade>`
     - |red|
     - |red|
     - |green|
   * -
     - :ref:`Settings <odoo-sh/branches/tabs/settings>`
     - |red|
     - |red|
     - |green|
   * -
     - Status
     - |green|
     - |green|
     - |green|

.. admonition:: Legend

   |green| : Available

   |red| : Not available

.. |green| raw:: html

   <span class="text-success" style="font-size: 32px; line-height: 32px; display: inline-block; vertical-align: middle;">‚óè</span>

.. |red| raw:: html

   <span class="text-danger" style="font-size: 32px; line-height: 32px; display: inline-block; vertical-align: middle;">‚óè</span>

.. note::
   - Only admins can access the audit logs and the project settings.
   - All roles can access the :doc:`builds page <builds>`, but the features available are specific
     to each role.

.. _odoo-sh/settings/public:

Public access
=============

When enabling :guilabel:`Allow public access`, the :doc:`builds page <builds>` becomes publicly
accessible, allowing visitors to connect to development builds. Visitors can also access :ref:`logs
<odoo-sh/branches/tabs/logs>`, the :ref:`shell <odoo-sh/branches/tabs/shell>`, and :ref:`mails
<odoo-sh/branches/tabs/mails>` for development builds. Production and staging builds remain private;
visitors can only view their status.

.. image:: settings/public-access.png
   :alt: The public access setting

.. _odoo-sh/settings/commit:

GitHub commit statuses
======================

You can add a GitHub token to allow Odoo.sh to push commit statuses back to GitHub. The token must
have the *commit statuses (write)* repository permission.

.. image:: settings/commit-statuses.png
   :alt: The GitHub commit statuses setting

.. seealso::
   For more information, refer to `GitHub‚Äôs documentation on managing access tokens <https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens>`_.

.. _odoo-sh/settings/key-webhook:

GitHub key and webhook
======================

A deploy key and a webhook are automatically created on your GitHub repository to allow Odoo.sh to
fetch code and receive commit notifications. As they can be unintentionally modified or deleted,
you can use the :guilabel:`Verify Deploy Key` and :guilabel:`Verify Webhook` buttons below to verify
their configuration.

.. image:: settings/key-webhook.png
   :alt: The GitHub key and webhook setting

.. note::
   Administrative rights on the GitHub repository are necessary.

.. _odoo-sh/settings/submodules:

Submodules
==========

The `git submodule` command allows you to `integrate other Git projects
<https://git-scm.com/book/en/v2/Git-Tools-Submodules>`_ into your codebase without copying the code
directly.

.. image:: settings/submodules.png
   :alt: The submodules setting
   :scale: 50%

.. note::
   A Git repository containing Odoo modules, for example from the `Odoo Apps Store
   <https://apps.odoo.com/apps>`_ or `community modules <https://github.com/OCA>`_, is necessary.

.. admonition:: Private repositories

   Before adding `private GitHub repository
   <https://help.github.com/articles/making-a-public-repository-private/>`_ as a submodule, it is
   necessary to add a deploy key:

   #. Paste the SSH URL of the sub-repository (e.g., `git@github.com:USERNAME/REPOSITORY.git`) and
      click :guilabel:`Add`.
   #. Copy the generated :guilabel:`Public Key`.
   #. On the sub-repository's GitHub, go to :menuselection:`Settings --> Deploy keys`.
   #. Click :menuselection:`Add deploy key`, enter a :guilabel:`Title`, paste the public key into
      the :guilabel:`Key` field, and click :guilabel:`Add key`.

To add a public repository or private repository with a deploy key as a submodule:

#. Add the submodule to your project.

   .. code-block:: shell

      git submodule add -b BRANCH git@github.com:USERNAME/REPOSITORY.git PATH

#. Commit and push the change.

   .. code-block:: shell

      git commit -a && git push -u origin master

#. Wait for Odoo.sh to rebuild the project.

.. _odoo-sh/settings/storage:

Production database size
========================

This section displays the total storage used by the project. It includes the PostgreSQL database
size and disk files in your container (database filestore, session storage, etc.). If the production
database exceeds the storage included in your subscription, the plan will be automatically adjusted.

.. image:: settings/database-size.png
   :alt: The production database size setting

.. tip::
   To analyze disk usage, run the `Ncdu tool <https://dev.yorhel.nl/ncdu/man>`_ in the :ref:`web
   shell <odoo-sh/branches/tabs/shell>`.

.. _odoo-sh/settings/workers:

Database workers
================

Additional database workers can be configured to allow your production database to handle higher
concurrent loads.

.. image:: settings/database-workers.png
   :alt: The database workers setting

To add more workers, contact your account manager. After payment, the new worker(s) will be added to
your project.

.. note::
   Adding more workers does not automatically fix performance issues. It only increases the number
   of concurrent connections the server can handle. If some operations remain slow, the issue is
   likely code-related. If it is not due to your customizations, contact `Odoo Support
   <https://www.odoo.com/help>`_.

.. _odoo-sh/settings/staging:

Staging branches
================

Additional staging branches allow you to develop and test multiple features simultaneously. To add
more staging branches, request a product increase directly from your Odoo.sh project. A widget will
guide you to the subscription portal to complete the purchase. After payment, synchronization with
Odoo.sh will occur automatically, and the number of available staging branches will be updated.

.. image:: settings/staging-branches.png
   :alt: The staging branches setting

.. _odoo-sh/settings/activation:

Activation
==========

This section shows the activation status of the project. You can change the activation code if
necessary, provided the new code is not already assigned to another project.

.. image:: settings/activation.png
   :alt: The staging branches setting

.. warning::
   You cannot change the activation code to:

   - A code already used in another project
   - A trial code (downgrading from paid to trial is not allowed)
   - An invalid code (not linked to an Odoo.sh custom plan)

   For any other issue, contact `Odoo Support <https://www.odoo.com/help>`_.
